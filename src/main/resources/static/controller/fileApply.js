layui.define(["table","admin","form"],(function(e){var t=layui.$,l=layui.admin,a=layui.table,i=(layui.view,layui.form,layer.load(1));a.render({elem:"#apply_list_table",cols:[[{field:"index",title:"序号"},{field:"title",title:"标题"},{field:"organizer",title:"承办单位"},{field:"initiatorUsername",title:"发起人",width:140},{field:"status",title:"审批进度",templet:"#apply_status",width:100},{field:"createTime",title:"发起时间",sort:!0},{title:"操作",width:200,align:"center",fixed:"right",toolbar:"#aplpy_list_table_edit"}]],url:"/approval/document/findAll",where:{},headers:{Authorization:layui.data("layuiAdmin").Authorization},page:!0,limit:30,response:{statusCode:200},parseData:function(e){return{code:e.code,msg:e.msg,count:e.data.totalElements,data:e.data.content.map((function(e,t){return e.createTime=window.utils.format(null,e.createTime),e.index=t+1,e}))}},done:function(e,t,a){layer.close(i),window.utils.dealCode(e.code,l),console.log(e),console.log(t),console.log(a)},text:{none:"暂无数据"}}),a.on("tool(apply_list_table)",(function(e){var t=e.data;console.log(t),"edit"===e.event&&(location.hash="/approve/viewApply/id="+t.id+"/type=1"),"del"===e.event&&layer.confirm("确定要撤回？",(function(e){var i=layer.load(1);l.reqAsync({url:"/approval/document/withdrawalOfApproval",method:"POST",data:{id:t.id},done:function(t){layer.close(i),t.code&&(a.reload("apply_list_table"),layer.close(e))}})}))}));var o={apply:function(){location.hash="/approve/createApply"}};t("#apply_btn").on("click",(function(){var e=t(this).data("type");o[e]&&o[e].call(this)})),e("fileApply",{})}));