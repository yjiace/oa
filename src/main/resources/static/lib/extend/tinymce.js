layui.define(["jquery"],(function(e){var t=layui.$,a=layui.cache.modules.tinymce,n=a.substr(0,a.lastIndexOf(".")),r=(layui.setter||{}).response||{},i="tinymce.min.js",s={base_url:n,images_upload_url:"",language:"zh_CN",response:{statusName:r.statusName||"code",msgName:r.msgName||"msg",dataName:r.dataName||"data",statusCode:r.statusCode||{ok:0}},success:function(e,t,a){e[this.response.statusName]==this.response.statusCode.ok?t(e[this.response.dataName]):a(e[this.response.msgName])}},l={};function o(){"undefined"==typeof tinymce&&t.ajax({url:s.base_url+"/"+i,dataType:"script",cache:!0,async:!1})}function u(e){return null!=e}l.render=function(e,a){var n=layui.admin||{},r=e.form||{},c=r.name||"edit",m=r.data||{};e.suffix=u(e.suffix)?e.suffix:i.indexOf(".min")>-1?".min":"",e.base_url=u(e.base_url)?e.base_url:s.base_url,e.language=u(e.language)?e.language:s.language,e.selector=u(e.selector)?e.selector:e.elem,e.quickbars_selection_toolbar=u(e.quickbars_selection_toolbar)?e.quickbars_selection_toolbar:"cut copy | bold italic underline strikethrough ",e.plugins=u(e.plugins)?e.plugins:"quickbars print preview searchreplace autolink fullscreen image link media codesample table charmap hr advlist lists wordcount imagetools indent2em",e.toolbar=u(e.toolbar)?e.toolbar:"undo redo | forecolor backcolor bold italic underline strikethrough | indent2em alignleft aligncenter alignright alignjustify outdent indent | link bullist numlist image table codesample | formatselect fontselect fontsizeselect",e.resize=!!u(e.resize)&&e.resize,e.elementpath=!!u(e.elementpath)&&e.elementpath,e.branding=!!u(e.branding)&&e.branding,e.contextmenu_never_use_native=!u(e.contextmenu_never_use_native)||e.contextmenu_never_use_native,e.menubar=u(e.menubar)?e.menubar:"file edit insert format table",e.images_upload_url=u(e.images_upload_url)?e.images_upload_url:s.images_upload_url,e.images_upload_handler=u(e.images_upload_handler)?e.images_upload_handler:function(a,r,i){if(function(e){if(null==e||""===e)return!0;if(e instanceof Array&&0===e.length)return!0;if("object"==typeof e&&0===Object.keys(e).length)return!0;return!1}(e.images_upload_url))return i("上传接口未配置"),console.error("images_upload_url未配置");var l=new FormData;if(l.append(c,a.blob()),"object"==typeof m)for(var o in m)l.append(o,m[o]);var u={url:e.images_upload_url,dataType:"json",type:"POST",data:l,processData:!1,contentType:!1,success:function(e){s.success(e,r,i)},error:function(e){i("网络错误："+e.status)}};"function"==typeof n.req?n.req(u):t.ajax(u)};var d=l.get(e.elem);return d&&d.destroy(),e.menu=u(e.menu)?e.menu:{file:{title:"文件",items:"newdocument | print preview fullscreen | wordcount"},edit:{title:"编辑",items:"undo redo | cut copy paste pastetext selectall | searchreplace"},format:{title:"格式",items:"bold italic underline strikethrough superscript subscript | formats | forecolor backcolor | removeformat"},table:{title:"表格",items:"inserttable tableprops deletetable | cell row column"}},o(),layui.sessionData("layui-tinymce",{key:e.selector,value:e}),tinymce.init(e),"function"==typeof a&&a.call(e),tinymce.activeEditor},l.init=l.render,l.get=function(e){if(o(),e&&/^#|\./.test(e)){var t=e.substr(1);return tinymce.editors[t]}return!1},l.reload=function(e,a){e=e||{};var n=l.get(e.elem),r=layui.sessionData("layui-tinymce")[e.elem];return n.destroy(),t.extend(r,e),tinymce.init(r),"function"==typeof a&&a.call(r),tinymce.activeEditor},l.autoRender=function(e,t){return"undefined"==typeof tinymce?l.render(e,t):tinymce.editors[e.elem.substr(1)]?l.reload(e,t):l.render(e,t)},e("tinymce",l)}));